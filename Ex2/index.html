<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Mini Shop</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- HTML: header hiá»ƒn thá»‹ tÃªn shop vÃ  badge sá»‘ lÆ°á»£ng mÃ³n trong giá» -->
  <header><h1>My Shop <span id="badge">0</span></h1></header>

  <!-- HTML: vÃ¹ng render danh sÃ¡ch sáº£n pháº©m Ä‘á»™ng -->
  <main>
    <section id="products"></section>

    <!-- HTML: khung giá» hÃ ng chá»©a danh sÃ¡ch má»¥c vÃ  tá»•ng tiá»n, áº©n khi rá»—ng -->
    <section id="cart" class="card" hidden>
      <h3>Cart</h3>
      <div id="items"></div>
      <div class="total">Total: $<span id="total">0.00</span></div>
    </section>
  </main>

<script>
/* JS: máº£ng dá»¯ liá»‡u sáº£n pháº©m máº«u dÃ¹ng Ä‘á»ƒ render Ä‘á»™ng */
const products = [
  {id:1,name:'Laptop',price:999.99,icon:'ðŸ’»'},
  {id:2,name:'Phone',price:699.99,icon:'ðŸ“±'},
  {id:3,name:'Headset',price:199.99,icon:'ðŸŽ§'},
  {id:4,name:'Watch',price:299.99,icon:'âŒš'}
];

/* JS: máº£ng lÆ°u tráº¡ng thÃ¡i giá» hÃ ng (má»—i item lÆ°u id vÃ  quantity) */
let cart = [];

/* JS: chá»n cÃ¡c pháº§n tá»­ DOM Ä‘á»ƒ cáº­p nháº­t giao diá»‡n (products, items, badge, cart, total) */
const productsEl = document.getElementById('products'),
      itemsEl = document.getElementById('items'),
      badge = document.getElementById('badge'),
      cartEl = document.getElementById('cart'),
      totalEl = document.getElementById('total');

/* JS: render danh sÃ¡ch sáº£n pháº©m ra DOM vÃ  gÃ¡n sá»± kiá»‡n nÃºt Add cho tá»«ng sáº£n pháº©m */
function renderProducts(){
  productsEl.innerHTML = products.map(p => `
    <div class="prod">
      <div class="icon">${p.icon}</div>
      <div>${p.name}</div>
      <div class="price">$${p.price.toFixed(2)}</div>
      <button onclick="add(${p.id})">Add</button>
    </div>
  `).join('');
}

/* JS: thÃªm sáº£n pháº©m vÃ o cart hoáº·c tÄƒng quantity náº¿u Ä‘Ã£ tá»“n táº¡i */
function add(id){
  const it = cart.find(x=>x.id===id);
  if(it) it.q++;
  else cart.push({id, q:1});
  renderCart();
}

/* JS: remove xÃ³a má»¥c khá»i cart theo id */
function remove(id){
  cart = cart.filter(x=>x.id!==id);
  renderCart();
}

/* JS: change thay Ä‘á»•i sá»‘ lÆ°á»£ng (tÄƒng/giáº£m) vÃ  xÃ³a khi qty <= 0 */
function change(id, delta){
  const it = cart.find(x=>x.id===id);
  if(!it) return;
  it.q += delta;
  if(it.q<=0) remove(id);
  renderCart();
}

/* JS: renderCart hiá»ƒn thá»‹ cÃ¡c má»¥c trong cart, tÃ­nh tá»•ng vÃ  cáº­p nháº­t badge; áº©n giá» khi rá»—ng */
function renderCart(){
  if(cart.length===0){ cartEl.hidden=true; badge.textContent='0'; totalEl.textContent='0.00'; itemsEl.innerHTML=''; return; }
  cartEl.hidden=false;
  badge.textContent = cart.reduce((s,i)=>s+i.q,0);
  itemsEl.innerHTML = cart.map(ci=>{
    const p = products.find(x=>x.id===ci.id);
    return `
      <div class="item">
        <div>${p.icon} ${p.name}</div>
        <div>$${(p.price*ci.q).toFixed(2)}</div>
        <div class="ctrl">
          <button onclick="change(${ci.id},-1)">-</button>
          <span>${ci.q}</span>
          <button onclick="change(${ci.id},1)">+</button>
          <button onclick="remove(${ci.id})">Remove</button>
        </div>
      </div>
    `;
  }).join('');
  totalEl.textContent = cart.reduce((s,ci)=>{
    const p = products.find(x=>x.id===ci.id); return s + p.price*ci.q;
  },0).toFixed(2);
}

/* JS: khá»Ÿi táº¡o hiá»ƒn thá»‹ sáº£n pháº©m khi trang load */
renderProducts();
</script>
</body>
</html>
